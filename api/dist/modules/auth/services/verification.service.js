'use strict';const a99_0x229d=['metadata','13HKDrdF','function','EntityNotFoundException','StringHelper','send','sourceId','href','30654WPZzqS','save','Inject','72026LqykIQ','verified','sendVerificationEmail','studioService','mailService','config','Verify\x20your\x20email\x20address','performer','UserService','../../mailer','user','findOne','__param','randomString','VERIFICATION_MODEL_PROVIDER','length','../providers/auth.provider','nestjs-config','../../performer/services','design:paramtypes','__esModule','MailerService','325987egsLNz','Injectable','235349fqRrdx','../../user/services','13198RYCYiB','248504DMtRgr','userService','VerificationModel','getOwnPropertyDescriptor','17pMmLwG','defineProperty','performerService','mongoose','value','updateVerificationStatus','__metadata','613861MwLrXL','VerificationService','sourceType','studio','get','../../../kernel','StudioService','1PSmrzY','decorate','set'];const a99_0x17aa58=a99_0x4242;function a99_0x4242(_0x41c68c,_0x5dc974){return a99_0x4242=function(_0x229df4,_0x42429f){_0x229df4=_0x229df4-0x126;let _0x3f8917=a99_0x229d[_0x229df4];return _0x3f8917;},a99_0x4242(_0x41c68c,_0x5dc974);}(function(_0x39b5fb,_0x3d52b2){const _0x42aa96=a99_0x4242;while(!![]){try{const _0x5b0638=parseInt(_0x42aa96(0x131))+-parseInt(_0x42aa96(0x156))+-parseInt(_0x42aa96(0x133))+parseInt(_0x42aa96(0x14c))*-parseInt(_0x42aa96(0x153))+parseInt(_0x42aa96(0x135))*parseInt(_0x42aa96(0x13a))+-parseInt(_0x42aa96(0x136))+-parseInt(_0x42aa96(0x148))*-parseInt(_0x42aa96(0x141));if(_0x5b0638===_0x3d52b2)break;else _0x39b5fb['push'](_0x39b5fb['shift']());}catch(_0x1f272f){_0x39b5fb['push'](_0x39b5fb['shift']());}}}(a99_0x229d,0x333a9));var __decorate=this&&this['__decorate']||function(_0x176a98,_0xb5a6f7,_0x2239e8,_0x3f3b36){const _0x3fceed=a99_0x4242;var _0x4a7241=arguments[_0x3fceed(0x12a)],_0x5960d2=_0x4a7241<0x3?_0xb5a6f7:_0x3f3b36===null?_0x3f3b36=Object[_0x3fceed(0x139)](_0xb5a6f7,_0x2239e8):_0x3f3b36,_0x4cc014;if(typeof Reflect==='object'&&typeof Reflect[_0x3fceed(0x149)]===_0x3fceed(0x14d))_0x5960d2=Reflect[_0x3fceed(0x149)](_0x176a98,_0xb5a6f7,_0x2239e8,_0x3f3b36);else{for(var _0x473f5a=_0x176a98['length']-0x1;_0x473f5a>=0x0;_0x473f5a--)if(_0x4cc014=_0x176a98[_0x473f5a])_0x5960d2=(_0x4a7241<0x3?_0x4cc014(_0x5960d2):_0x4a7241>0x3?_0x4cc014(_0xb5a6f7,_0x2239e8,_0x5960d2):_0x4cc014(_0xb5a6f7,_0x2239e8))||_0x5960d2;}return _0x4a7241>0x3&&_0x5960d2&&Object['defineProperty'](_0xb5a6f7,_0x2239e8,_0x5960d2),_0x5960d2;},__metadata=this&&this[a99_0x17aa58(0x140)]||function(_0x989d98,_0x17291e){const _0x30ae8b=a99_0x17aa58;if(typeof Reflect==='object'&&typeof Reflect[_0x30ae8b(0x14b)]==='function')return Reflect['metadata'](_0x989d98,_0x17291e);},__param=this&&this[a99_0x17aa58(0x127)]||function(_0x4d19dc,_0x300c7e){return function(_0x483b14,_0x7c5a74){_0x300c7e(_0x483b14,_0x7c5a74,_0x4d19dc);};};Object[a99_0x17aa58(0x13b)](exports,a99_0x17aa58(0x12f),{'value':!![]}),exports[a99_0x17aa58(0x142)]=void 0x0;const common_1=require('@nestjs/common'),mongoose_1=require(a99_0x17aa58(0x13d)),kernel_1=require(a99_0x17aa58(0x146)),mailer_1=require(a99_0x17aa58(0x15f)),nestjs_config_1=require(a99_0x17aa58(0x12c)),services_1=require(a99_0x17aa58(0x134)),services_2=require(a99_0x17aa58(0x12d)),services_3=require('../../studio/services'),auth_provider_1=require(a99_0x17aa58(0x12b));let VerificationService=class VerificationService{constructor(_0x2681cd,_0x183d4a,_0xb28776,_0x860e26,_0x351226,_0x478b36){const _0x30a286=a99_0x17aa58;this['VerificationModel']=_0x2681cd,this['mailService']=_0x183d4a,this[_0x30a286(0x15b)]=_0xb28776,this[_0x30a286(0x137)]=_0x860e26,this['performerService']=_0x351226,this[_0x30a286(0x159)]=_0x478b36;}async[a99_0x17aa58(0x158)](_0x3db377,_0x3e31bc,_0x4f4115){const _0x3bb069=a99_0x17aa58;let _0x5a55e6=await this['VerificationModel'][_0x3bb069(0x126)]({'sourceId':_0x3db377,'value':_0x3e31bc});!_0x5a55e6&&(_0x5a55e6=new this[(_0x3bb069(0x138))]());const _0x177005=kernel_1[_0x3bb069(0x14f)][_0x3bb069(0x128)](0xf);_0x5a55e6[_0x3bb069(0x14a)](_0x3bb069(0x151),_0x3db377),_0x5a55e6['set'](_0x3bb069(0x143),_0x4f4115),_0x5a55e6[_0x3bb069(0x14a)](_0x3bb069(0x13e),_0x3e31bc),_0x5a55e6[_0x3bb069(0x14a)]('token',_0x177005),await _0x5a55e6[_0x3bb069(0x154)]();const _0x38dbd8=new URL('auth/email-verification?token='+_0x177005,this[_0x3bb069(0x15b)][_0x3bb069(0x145)]('app.baseUrl'))[_0x3bb069(0x152)];await this[_0x3bb069(0x15a)][_0x3bb069(0x150)]({'to':_0x3e31bc,'subject':_0x3bb069(0x15c),'data':{'verificationLink':_0x38dbd8},'template':'email-verification'});}async['verifyEmail'](_0x3d87d7){const _0x539349=a99_0x17aa58,_0x2f248e=await this[_0x539349(0x138)][_0x539349(0x126)]({'token':_0x3d87d7});if(!_0x2f248e)throw new kernel_1[(_0x539349(0x14e))]();_0x2f248e[_0x539349(0x157)]=!![],await _0x2f248e['save']();switch(_0x2f248e[_0x539349(0x143)]){case _0x539349(0x160):await this[_0x539349(0x137)][_0x539349(0x13f)](_0x2f248e[_0x539349(0x151)]);break;case _0x539349(0x15d):await this[_0x539349(0x13c)][_0x539349(0x13f)](_0x2f248e[_0x539349(0x151)]);break;case _0x539349(0x144):await this[_0x539349(0x159)][_0x539349(0x13f)](_0x2f248e[_0x539349(0x151)]);break;default:break;}}};VerificationService=__decorate([common_1[a99_0x17aa58(0x132)](),__param(0x0,common_1[a99_0x17aa58(0x155)](auth_provider_1[a99_0x17aa58(0x129)])),__metadata(a99_0x17aa58(0x12e),[mongoose_1['Model'],mailer_1[a99_0x17aa58(0x130)],nestjs_config_1['ConfigService'],services_1[a99_0x17aa58(0x15e)],services_2['PerformerService'],services_3[a99_0x17aa58(0x147)]])],VerificationService),exports[a99_0x17aa58(0x142)]=VerificationService;