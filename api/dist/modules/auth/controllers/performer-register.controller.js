'use strict';const a54_0x1f9f=['trim','EXCLUDE_FIELDS','defineProperty','__esModule','5022ZhFezQ','documentDir','PerformerRegisterController','PERFORMER_STATUSES','HttpCode','omit','27905hjnyzL','197699elYfge','design:paramtypes','auth/performers','PerformerService','FilesUploaded','email','@nestjs/common','design:returntype','authService','username','FileService','UseInterceptors','DataResponse','__decorate','252314Wugawr','MultiFileUploadInterceptor','performerRegister','performer','AuthService','fileService','documentVerification','Missing\x20document!','Post','__metadata','design:type','../../file/services','104hjkZTV','VerificationService','assign','HttpException','_id','../../performer/constants','decorate','idVerification','getConfig','sendVerificationEmail','37XXEifK','verificationService','PerformerRegisterPayload','prototype','HttpStatus','../../../kernel/constants','591BAjfUa','Body','7NmiZbB','../../file','../services','object','1843PFvtiC','metadata','Your\x20register\x20has\x20been\x20successfully.','password','505376raMqkx','function','length','20gEPfWj','__param','getValueByKey','../../performer/services','performerService','performer-document','14930lVqYlU','Controller'];const a54_0x533c03=a54_0x4f71;(function(_0x4ae2e4,_0x1a6fa3){const _0x482996=a54_0x4f71;while(!![]){try{const _0x1137ff=parseInt(_0x482996(0x8d))+-parseInt(_0x482996(0xab))*parseInt(_0x482996(0xc9))+-parseInt(_0x482996(0xb6))*parseInt(_0x482996(0xbc))+-parseInt(_0x482996(0xa3))*-parseInt(_0x482996(0xc8))+parseInt(_0x482996(0xc2))*parseInt(_0x482996(0x99))+parseInt(_0x482996(0xaf))*parseInt(_0x482996(0xa9))+-parseInt(_0x482996(0xb3));if(_0x1137ff===_0x1a6fa3)break;else _0x4ae2e4['push'](_0x4ae2e4['shift']());}catch(_0xf6bfd5){_0x4ae2e4['push'](_0x4ae2e4['shift']());}}}(a54_0x1f9f,0xacf4f));var __decorate=this&&this[a54_0x533c03(0xd6)]||function(_0x111c9f,_0x2698c1,_0x5183e1,_0x234ca4){const _0x27ff13=a54_0x533c03;var _0x4ccd9d=arguments[_0x27ff13(0xb5)],_0x41dc9a=_0x4ccd9d<0x3?_0x2698c1:_0x234ca4===null?_0x234ca4=Object['getOwnPropertyDescriptor'](_0x2698c1,_0x5183e1):_0x234ca4,_0xfa7f6e;if(typeof Reflect===_0x27ff13(0xae)&&typeof Reflect[_0x27ff13(0x9f)]===_0x27ff13(0xb4))_0x41dc9a=Reflect[_0x27ff13(0x9f)](_0x111c9f,_0x2698c1,_0x5183e1,_0x234ca4);else{for(var _0x22c8be=_0x111c9f[_0x27ff13(0xb5)]-0x1;_0x22c8be>=0x0;_0x22c8be--)if(_0xfa7f6e=_0x111c9f[_0x22c8be])_0x41dc9a=(_0x4ccd9d<0x3?_0xfa7f6e(_0x41dc9a):_0x4ccd9d>0x3?_0xfa7f6e(_0x2698c1,_0x5183e1,_0x41dc9a):_0xfa7f6e(_0x2698c1,_0x5183e1))||_0x41dc9a;}return _0x4ccd9d>0x3&&_0x41dc9a&&Object['defineProperty'](_0x2698c1,_0x5183e1,_0x41dc9a),_0x41dc9a;},__metadata=this&&this[a54_0x533c03(0x96)]||function(_0x4157bd,_0x2fd731){const _0x3317ee=a54_0x533c03;if(typeof Reflect==='object'&&typeof Reflect[_0x3317ee(0xb0)]===_0x3317ee(0xb4))return Reflect[_0x3317ee(0xb0)](_0x4157bd,_0x2fd731);},__param=this&&this[a54_0x533c03(0xb7)]||function(_0x486e62,_0x48e241){return function(_0x3bfe7f,_0x3eca44){_0x48e241(_0x3bfe7f,_0x3eca44,_0x486e62);};};Object[a54_0x533c03(0xc0)](exports,a54_0x533c03(0xc1),{'value':!![]}),exports[a54_0x533c03(0xc4)]=void 0x0;const common_1=require(a54_0x533c03(0xcf)),kernel_1=require('../../../kernel'),settings_1=require('../../settings'),file_1=require(a54_0x533c03(0xac)),services_1=require(a54_0x533c03(0x98)),services_2=require(a54_0x533c03(0xb9)),constants_1=require(a54_0x533c03(0x9e)),lodash_1=require('lodash'),constants_2=require(a54_0x533c03(0xa8)),payloads_1=require('../payloads'),services_3=require(a54_0x533c03(0xad));function a54_0x4f71(_0x44e971,_0x2d75d3){return a54_0x4f71=function(_0x1f9f4d,_0x4f719e){_0x1f9f4d=_0x1f9f4d-0x8d;let _0x5c9f76=a54_0x1f9f[_0x1f9f4d];return _0x5c9f76;},a54_0x4f71(_0x44e971,_0x2d75d3);}let PerformerRegisterController=class PerformerRegisterController{constructor(_0x3e926b,_0x455522,_0x5605d2,_0x2ae52a){const _0x1996c7=a54_0x533c03;this[_0x1996c7(0xba)]=_0x3e926b,this[_0x1996c7(0xd1)]=_0x455522,this[_0x1996c7(0xa4)]=_0x5605d2,this[_0x1996c7(0x92)]=_0x2ae52a;}async[a54_0x533c03(0x8f)](_0x41ce74,_0x4cfca7){const _0x32e507=a54_0x533c03;try{if(!_0x4cfca7[_0x32e507(0xa0)]||!_0x4cfca7['documentVerification'])throw new common_1[(_0x32e507(0x9c))](_0x32e507(0x94),0x190);const _0x837a91=settings_1['SettingService'][_0x32e507(0xb8)]('requireEmailVerification'),_0x1a9737=await this['performerService']['register'](Object[_0x32e507(0x9b)](Object[_0x32e507(0x9b)]({},lodash_1[_0x32e507(0xc7)](_0x41ce74,constants_2[_0x32e507(0xbf)])),{'avatarId':null,'emailVerified':!_0x837a91,'status':_0x837a91?constants_1['PERFORMER_STATUSES']['PENDING']:constants_1[_0x32e507(0xc5)]['ACTIVE'],'idVerificationId':_0x4cfca7[_0x32e507(0xa0)][_0x32e507(0x9d)],'documentVerificationId':_0x4cfca7['documentVerification'][_0x32e507(0x9d)]}));return await Promise['all']([this[_0x32e507(0xd1)]['create']({'source':'performer','sourceId':_0x1a9737[_0x32e507(0x9d)],'type':_0x32e507(0xce),'key':_0x1a9737[_0x32e507(0xce)]['toLowerCase']()[_0x32e507(0xbe)](),'value':_0x41ce74['password']}),this[_0x32e507(0xd1)]['create']({'source':'performer','sourceId':_0x1a9737[_0x32e507(0x9d)],'type':_0x32e507(0xd2),'key':_0x1a9737['username']['trim'](),'value':_0x41ce74[_0x32e507(0xb2)]})]),_0x837a91&&await this['verificationService'][_0x32e507(0xa2)](_0x1a9737[_0x32e507(0x9d)],_0x1a9737[_0x32e507(0xce)],_0x32e507(0x90)),kernel_1[_0x32e507(0xd5)]['ok']({'message':_0x837a91?'We\x20have\x20sent\x20an\x20email\x20to\x20verify\x20your\x20email,\x20please\x20check\x20your\x20inbox.':_0x32e507(0xb1)});}catch(_0x3e0e88){_0x4cfca7['idVerification']&&await this['fileService']['remove'](_0x4cfca7[_0x32e507(0xa0)][_0x32e507(0x9d)]),_0x4cfca7[_0x32e507(0x93)]&&await this['fileService']['remove'](_0x4cfca7['documentVerification']['_id']);throw _0x3e0e88;}}};__decorate([common_1[a54_0x533c03(0x95)]('register'),common_1[a54_0x533c03(0xc6)](common_1[a54_0x533c03(0xa7)]['OK']),common_1[a54_0x533c03(0xd4)](file_1[a54_0x533c03(0x8e)]([{'type':a54_0x533c03(0xbb),'fieldName':a54_0x533c03(0xa0),'options':{'destination':kernel_1[a54_0x533c03(0xa1)]('file')['documentDir']}},{'type':'performer-document','fieldName':a54_0x533c03(0x93),'options':{'destination':kernel_1[a54_0x533c03(0xa1)]('file')[a54_0x533c03(0xc3)]}}],{})),__param(0x0,common_1[a54_0x533c03(0xaa)]()),__param(0x1,file_1[a54_0x533c03(0xcd)]()),__metadata(a54_0x533c03(0x97),Function),__metadata(a54_0x533c03(0xca),[payloads_1[a54_0x533c03(0xa5)],Object]),__metadata(a54_0x533c03(0xd0),Promise)],PerformerRegisterController[a54_0x533c03(0xa6)],a54_0x533c03(0x8f),null),PerformerRegisterController=__decorate([common_1[a54_0x533c03(0xbd)](a54_0x533c03(0xcb)),__metadata(a54_0x533c03(0xca),[services_2[a54_0x533c03(0xcc)],services_3[a54_0x533c03(0x91)],services_3[a54_0x533c03(0x9a)],services_1[a54_0x533c03(0xd3)]])],PerformerRegisterController),exports[a54_0x533c03(0xc4)]=PerformerRegisterController;