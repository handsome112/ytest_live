'use strict';const a327_0x4b0a=['__param','../../performer-assets/constants','EVENT','updateOne','defineProperty','CREATED','mongoose','decorate','DELETED','PERFORMER_PHOTO_CHANNEL','__esModule','35MMOLaI','UPDATED','handleProductCount','../providers','24201xWieRb','subscribe','bind','PRODUCT_STATUS','performerModel','Model','getOwnPropertyDescriptor','PERFORMER_VIDEO_CHANNEL','76900jZQCIE','PERFORMER_MODEL_PROVIDER','object','VIDEO_STATUS','678929ViBDoO','handlePhotoCount','queueEventService','630473PsWLkN','includes','2fcTAbz','Inject','../../../kernel/constants','__decorate','function','metadata','502829fKLObl','__metadata','data','PERFORMER_PRODUCT_CHANNEL','@nestjs/common','39BsKdGM','log','937470rwiNae','1tNCfvF','14656AbStju','ACTIVE','handleVideoCount','PHOTO_STATUS','PerformerAssetsListener','../../../kernel'];const a327_0x140c7b=a327_0x123b;(function(_0x208b83,_0xd46ee0){const _0x42b6e3=a327_0x123b;while(!![]){try{const _0x4774c9=-parseInt(_0x42b6e3(0x208))*-parseInt(_0x42b6e3(0x20c))+-parseInt(_0x42b6e3(0x1ee))*parseInt(_0x42b6e3(0x1e8))+parseInt(_0x42b6e3(0x1f7))+-parseInt(_0x42b6e3(0x1f5))+parseInt(_0x42b6e3(0x1f6))*-parseInt(_0x42b6e3(0x1e6))+-parseInt(_0x42b6e3(0x1e3))+-parseInt(_0x42b6e3(0x1df))*-parseInt(_0x42b6e3(0x1f3));if(_0x4774c9===_0xd46ee0)break;else _0x208b83['push'](_0x208b83['shift']());}catch(_0x4802cc){_0x208b83['push'](_0x208b83['shift']());}}}(a327_0x4b0a,0x94805));function a327_0x123b(_0x43baa0,_0x28a0a3){return a327_0x123b=function(_0x4b0a1b,_0x123bf8){_0x4b0a1b=_0x4b0a1b-0x1dc;let _0x31e16b=a327_0x4b0a[_0x4b0a1b];return _0x31e16b;},a327_0x123b(_0x43baa0,_0x28a0a3);}var __decorate=this&&this[a327_0x140c7b(0x1eb)]||function(_0x22287c,_0x52b173,_0x4befab,_0x506aad){const _0x227062=a327_0x140c7b;var _0x55b72a=arguments['length'],_0x5d3c62=_0x55b72a<0x3?_0x52b173:_0x506aad===null?_0x506aad=Object[_0x227062(0x1dd)](_0x52b173,_0x4befab):_0x506aad,_0x5d652c;if(typeof Reflect===_0x227062(0x1e1)&&typeof Reflect[_0x227062(0x204)]===_0x227062(0x1ec))_0x5d3c62=Reflect[_0x227062(0x204)](_0x22287c,_0x52b173,_0x4befab,_0x506aad);else{for(var _0x36fbd5=_0x22287c['length']-0x1;_0x36fbd5>=0x0;_0x36fbd5--)if(_0x5d652c=_0x22287c[_0x36fbd5])_0x5d3c62=(_0x55b72a<0x3?_0x5d652c(_0x5d3c62):_0x55b72a>0x3?_0x5d652c(_0x52b173,_0x4befab,_0x5d3c62):_0x5d652c(_0x52b173,_0x4befab))||_0x5d3c62;}return _0x55b72a>0x3&&_0x5d3c62&&Object[_0x227062(0x201)](_0x52b173,_0x4befab,_0x5d3c62),_0x5d3c62;},__metadata=this&&this[a327_0x140c7b(0x1ef)]||function(_0x978859,_0x4507b2){const _0x487a5f=a327_0x140c7b;if(typeof Reflect===_0x487a5f(0x1e1)&&typeof Reflect[_0x487a5f(0x1ed)]===_0x487a5f(0x1ec))return Reflect[_0x487a5f(0x1ed)](_0x978859,_0x4507b2);},__param=this&&this[a327_0x140c7b(0x1fd)]||function(_0x132c1a,_0x40fb85){return function(_0x288cd9,_0x1d7d73){_0x40fb85(_0x288cd9,_0x1d7d73,_0x132c1a);};};Object[a327_0x140c7b(0x201)](exports,a327_0x140c7b(0x207),{'value':!![]}),exports[a327_0x140c7b(0x1fb)]=void 0x0;const common_1=require(a327_0x140c7b(0x1f2)),kernel_1=require(a327_0x140c7b(0x1fc)),constants_1=require(a327_0x140c7b(0x1fe)),mongoose_1=require(a327_0x140c7b(0x203)),constants_2=require(a327_0x140c7b(0x1ea)),providers_1=require(a327_0x140c7b(0x20b)),HANDLE_PHOTO_COUNT_FOR_PERFORMER='HANDLE_PHOTO_COUNT_FOR_PERFORMER';let PerformerAssetsListener=class PerformerAssetsListener{constructor(_0x229c18,_0xb8dea8){const _0x2a31e3=a327_0x140c7b;this[_0x2a31e3(0x1e5)]=_0x229c18,this[_0x2a31e3(0x210)]=_0xb8dea8,this['queueEventService'][_0x2a31e3(0x20d)](constants_1[_0x2a31e3(0x206)],HANDLE_PHOTO_COUNT_FOR_PERFORMER,this['handlePhotoCount'][_0x2a31e3(0x20e)](this)),this[_0x2a31e3(0x1e5)][_0x2a31e3(0x20d)](constants_1[_0x2a31e3(0x1de)],HANDLE_PHOTO_COUNT_FOR_PERFORMER,this[_0x2a31e3(0x1f9)][_0x2a31e3(0x20e)](this)),this['queueEventService'][_0x2a31e3(0x20d)](constants_1[_0x2a31e3(0x1f1)],HANDLE_PHOTO_COUNT_FOR_PERFORMER,this[_0x2a31e3(0x20a)][_0x2a31e3(0x20e)](this));}async[a327_0x140c7b(0x1e4)](_0x18cff2){const _0x4c1171=a327_0x140c7b;try{const {eventName:_0x1f3a83}=_0x18cff2;if(![constants_2[_0x4c1171(0x1ff)]['CREATED'],constants_2[_0x4c1171(0x1ff)][_0x4c1171(0x205)],constants_2[_0x4c1171(0x1ff)][_0x4c1171(0x209)]]['includes'](_0x1f3a83))return;const {performerId:_0x357899,status:_0x588695,oldStatus:_0x3736ff}=_0x18cff2[_0x4c1171(0x1f0)];let _0x4e7c69=0x0;switch(_0x1f3a83){case constants_2[_0x4c1171(0x1ff)][_0x4c1171(0x202)]:if(_0x588695===constants_1['PHOTO_STATUS']['ACTIVE'])_0x4e7c69=0x1;break;case constants_2[_0x4c1171(0x1ff)][_0x4c1171(0x209)]:if(_0x3736ff!==constants_1[_0x4c1171(0x1fa)][_0x4c1171(0x1f8)]&&_0x588695===constants_1['PHOTO_STATUS'][_0x4c1171(0x1f8)])_0x4e7c69=0x1;if(_0x3736ff===constants_1['PHOTO_STATUS'][_0x4c1171(0x1f8)]&&_0x588695!==constants_1[_0x4c1171(0x1fa)]['ACTIVE'])_0x4e7c69=-0x1;break;case constants_2[_0x4c1171(0x1ff)][_0x4c1171(0x205)]:if(_0x588695===constants_1['PHOTO_STATUS'][_0x4c1171(0x1f8)])_0x4e7c69=-0x1;break;default:break;}_0x4e7c69&&await this['performerModel'][_0x4c1171(0x200)]({'_id':_0x357899},{'$inc':{'stats.totalPhotos':_0x4e7c69}});}catch(_0x130810){console[_0x4c1171(0x1f4)](_0x130810);}}async[a327_0x140c7b(0x1f9)](_0x1cbf64){const _0x1d5204=a327_0x140c7b;try{const {eventName:_0x52d431}=_0x1cbf64;if(![constants_2[_0x1d5204(0x1ff)]['CREATED'],constants_2[_0x1d5204(0x1ff)][_0x1d5204(0x205)],constants_2[_0x1d5204(0x1ff)]['UPDATED']]['includes'](_0x52d431))return;const {performerId:_0x17664d,status:_0xbc181f,oldStatus:_0x137bfa}=_0x1cbf64[_0x1d5204(0x1f0)];let _0x53a8b=0x0;switch(_0x52d431){case constants_2['EVENT'][_0x1d5204(0x202)]:if(_0xbc181f===constants_1[_0x1d5204(0x1e2)][_0x1d5204(0x1f8)])_0x53a8b=0x1;break;case constants_2[_0x1d5204(0x1ff)][_0x1d5204(0x209)]:if(_0x137bfa!==constants_1[_0x1d5204(0x1e2)]['ACTIVE']&&_0xbc181f===constants_1[_0x1d5204(0x1e2)][_0x1d5204(0x1f8)])_0x53a8b=0x1;if(_0x137bfa===constants_1[_0x1d5204(0x1e2)][_0x1d5204(0x1f8)]&&_0xbc181f!==constants_1[_0x1d5204(0x1e2)][_0x1d5204(0x1f8)])_0x53a8b=-0x1;break;case constants_2[_0x1d5204(0x1ff)][_0x1d5204(0x205)]:if(_0xbc181f===constants_1[_0x1d5204(0x1e2)]['ACTIVE'])_0x53a8b=-0x1;break;default:break;}_0x53a8b&&await this['performerModel'][_0x1d5204(0x200)]({'_id':_0x17664d},{'$inc':{'stats.totalVideos':_0x53a8b}});}catch(_0x2b7d9b){console[_0x1d5204(0x1f4)](_0x2b7d9b);}}async[a327_0x140c7b(0x20a)](_0x5dd639){const _0x416211=a327_0x140c7b;try{const {eventName:_0x548a4d}=_0x5dd639;if(![constants_2['EVENT'][_0x416211(0x202)],constants_2[_0x416211(0x1ff)][_0x416211(0x205)],constants_2[_0x416211(0x1ff)][_0x416211(0x209)]][_0x416211(0x1e7)](_0x548a4d))return;const {performerId:_0x2dfe72,status:_0x36bb30,oldStatus:_0x30274c}=_0x5dd639[_0x416211(0x1f0)];let _0x5725bc=0x0;switch(_0x548a4d){case constants_2[_0x416211(0x1ff)][_0x416211(0x202)]:if(_0x36bb30===constants_1[_0x416211(0x20f)][_0x416211(0x1f8)])_0x5725bc=0x1;break;case constants_2[_0x416211(0x1ff)][_0x416211(0x209)]:if(_0x30274c!==constants_1[_0x416211(0x20f)]['ACTIVE']&&_0x36bb30===constants_1[_0x416211(0x20f)][_0x416211(0x1f8)])_0x5725bc=0x1;if(_0x30274c===constants_1['PRODUCT_STATUS'][_0x416211(0x1f8)]&&_0x36bb30!==constants_1[_0x416211(0x20f)]['ACTIVE'])_0x5725bc=-0x1;break;case constants_2['EVENT']['DELETED']:if(_0x36bb30===constants_1[_0x416211(0x20f)][_0x416211(0x1f8)])_0x5725bc=-0x1;break;default:break;}_0x5725bc&&await this[_0x416211(0x210)][_0x416211(0x200)]({'_id':_0x2dfe72},{'$inc':{'stats.totalProducts':_0x5725bc}});}catch(_0x881c64){console['log'](_0x881c64);}}};PerformerAssetsListener=__decorate([common_1['Injectable'](),__param(0x1,common_1[a327_0x140c7b(0x1e9)](providers_1[a327_0x140c7b(0x1e0)])),__metadata('design:paramtypes',[kernel_1['QueueEventService'],mongoose_1[a327_0x140c7b(0x1dc)]])],PerformerAssetsListener),exports[a327_0x140c7b(0x1fb)]=PerformerAssetsListener;