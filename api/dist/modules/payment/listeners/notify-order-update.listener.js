'use strict';const a255_0x36da=['UserService','52zXtTWf','15RHzOmf','MailerService','../../user/services','11302GxvJyK','userService','@nestjs/common','UpdateOrderStatusListener','57702dqhdTc','889697bPpypW','includes','../../../kernel/constants','QueueEventService','eventName','metadata','send','length','decorate','1YUQSoU','handler','__decorate','update-order-status','bind','Logger','subscribe','801677wLUnIe','../../mailer/services','data','__metadata','559591bopsru','mailService','error','EVENT','6tHpJTF','117089pauBCp','buyerSource','queueEventService','function','Injectable','__esModule','getOwnPropertyDescriptor','newValue','Order\x20','user','../constants','NotifyOrderUpdateListener','object','email','logger','orderNumber','deliveryStatus','728938leMxTY'];const a255_0x4ad32d=a255_0x4fb9;(function(_0x5a3efc,_0x28ba4b){const _0x4ea178=a255_0x4fb9;while(!![]){try{const _0x5b9b32=parseInt(_0x4ea178(0x11a))+parseInt(_0x4ea178(0x125))+-parseInt(_0x4ea178(0x109))*-parseInt(_0x4ea178(0x108))+-parseInt(_0x4ea178(0x11d))*parseInt(_0x4ea178(0x124))+-parseInt(_0x4ea178(0x100))+-parseInt(_0x4ea178(0x104))*-parseInt(_0x4ea178(0x12e))+-parseInt(_0x4ea178(0x120))*parseInt(_0x4ea178(0x11c));if(_0x5b9b32===_0x28ba4b)break;else _0x5a3efc['push'](_0x5a3efc['shift']());}catch(_0x512230){_0x5a3efc['push'](_0x5a3efc['shift']());}}}(a255_0x36da,0x98cb9));function a255_0x4fb9(_0x25e622,_0x2c8862){return a255_0x4fb9=function(_0x36da56,_0x4fb9bc){_0x36da56=_0x36da56-0xfc;let _0x33aca2=a255_0x36da[_0x36da56];return _0x33aca2;},a255_0x4fb9(_0x25e622,_0x2c8862);}var __decorate=this&&this[a255_0x4ad32d(0x130)]||function(_0x2c649d,_0x9c427b,_0x4e2d33,_0x46ebfd){const _0x50c589=a255_0x4ad32d;var _0x2a14f1=arguments[_0x50c589(0x12c)],_0xe85d51=_0x2a14f1<0x3?_0x9c427b:_0x46ebfd===null?_0x46ebfd=Object[_0x50c589(0x10f)](_0x9c427b,_0x4e2d33):_0x46ebfd,_0x2092f8;if(typeof Reflect===_0x50c589(0x115)&&typeof Reflect[_0x50c589(0x12d)]==='function')_0xe85d51=Reflect[_0x50c589(0x12d)](_0x2c649d,_0x9c427b,_0x4e2d33,_0x46ebfd);else{for(var _0x8db432=_0x2c649d[_0x50c589(0x12c)]-0x1;_0x8db432>=0x0;_0x8db432--)if(_0x2092f8=_0x2c649d[_0x8db432])_0xe85d51=(_0x2a14f1<0x3?_0x2092f8(_0xe85d51):_0x2a14f1>0x3?_0x2092f8(_0x9c427b,_0x4e2d33,_0xe85d51):_0x2092f8(_0x9c427b,_0x4e2d33))||_0xe85d51;}return _0x2a14f1>0x3&&_0xe85d51&&Object['defineProperty'](_0x9c427b,_0x4e2d33,_0xe85d51),_0xe85d51;},__metadata=this&&this[a255_0x4ad32d(0x103)]||function(_0x551152,_0x3b3010){const _0x5783b3=a255_0x4ad32d;if(typeof Reflect===_0x5783b3(0x115)&&typeof Reflect[_0x5783b3(0x12a)]===_0x5783b3(0x10c))return Reflect[_0x5783b3(0x12a)](_0x551152,_0x3b3010);};Object['defineProperty'](exports,a255_0x4ad32d(0x10e),{'value':!![]}),exports[a255_0x4ad32d(0x114)]=void 0x0;const common_1=require(a255_0x4ad32d(0x122)),kernel_1=require('../../../kernel'),constants_1=require(a255_0x4ad32d(0x113)),constants_2=require(a255_0x4ad32d(0x127)),services_1=require(a255_0x4ad32d(0x101)),services_2=require(a255_0x4ad32d(0x11f)),EMAIL_NOTIFY_ORDER_UPDATE='EMAIL_NOTIFY_ORDER_UPDATE';let NotifyOrderUpdateListener=class NotifyOrderUpdateListener{constructor(_0x8a8d3c,_0x4d0061,_0x35aff1){const _0x4213bc=a255_0x4ad32d;this['queueEventService']=_0x8a8d3c,this[_0x4213bc(0x105)]=_0x4d0061,this[_0x4213bc(0x121)]=_0x35aff1,this[_0x4213bc(0x117)]=new common_1[(_0x4213bc(0xfe))](_0x4213bc(0x123)),this[_0x4213bc(0x10b)][_0x4213bc(0xff)](constants_1['ORDER_UPDATE_CHANNEL'],EMAIL_NOTIFY_ORDER_UPDATE,this[_0x4213bc(0x12f)][_0x4213bc(0xfd)](this));}async[a255_0x4ad32d(0x12f)](_0x4cf5ef){const _0x5907ac=a255_0x4ad32d;var _0x5cac04;try{if(![constants_2[_0x5907ac(0x107)]['UPDATED']][_0x5907ac(0x126)](_0x4cf5ef[_0x5907ac(0x129)]))return;const _0x2c874c=_0x4cf5ef[_0x5907ac(0x102)][_0x5907ac(0x110)];if(_0x2c874c[_0x5907ac(0x10a)]!==_0x5907ac(0x112))return;const _0x95a196=await this[_0x5907ac(0x121)]['findById'](_0x2c874c['buyerId']);if(!_0x95a196||!_0x95a196[_0x5907ac(0x116)])return;_0x95a196[_0x5907ac(0x116)]&&await this[_0x5907ac(0x105)][_0x5907ac(0x12b)]({'subject':_0x5907ac(0x111)+_0x2c874c[_0x5907ac(0x118)]+'\x20has\x20been\x20updated','to':_0x95a196[_0x5907ac(0x116)],'data':{'user':_0x95a196,'order':_0x2c874c,'oldDeliveryStatus':(_0x5cac04=_0x4cf5ef[_0x5907ac(0x102)]['oldValue'])===null||_0x5cac04===void 0x0?void 0x0:_0x5cac04[_0x5907ac(0x119)]},'template':_0x5907ac(0xfc)});}catch(_0x4d4106){this[_0x5907ac(0x117)][_0x5907ac(0x106)](_0x4d4106);}}};NotifyOrderUpdateListener=__decorate([common_1[a255_0x4ad32d(0x10d)](),__metadata('design:paramtypes',[kernel_1[a255_0x4ad32d(0x128)],services_1[a255_0x4ad32d(0x11e)],services_2[a255_0x4ad32d(0x11b)]])],NotifyOrderUpdateListener),exports[a255_0x4ad32d(0x114)]=NotifyOrderUpdateListener;