'use strict';const a563_0x1007=['Inject','addRef','146197vKXBCg','FileService','findById','log','__param','31wntvaN','STUDIO_EVENT_NAME','metadata','SettingService','CREATED','decorate','getKeyValue','STUDIO_CREATED','STUDIO_MODEL_PROVIDER','../providers','env','363382kkgmtC','__metadata','studio-document','defineProperty','queueEventService','settingService','5316jOzdnB','all','57vxmRbu','COMMISSION_RATE','updateOne','ModelListener','_id','studioModel','mongoose','1481xtKizn','subscribe','length','createStudioHandler','25ZwYQfP','14233kVNQZk','commission','SETTING_KEYS','StudioService','eventName','../constants','STUDIO_CHANNEL','30WJtrik','43clSWuk','Injectable','@nestjs/common','function','__decorate','bind','studioService','3923QeNPgF','design:paramtypes','STUDIO_COMMISSION','3083yrbcsq'];const a563_0x1c5e3f=a563_0x3383;(function(_0x47525b,_0x545964){const _0x1bc98d=a563_0x3383;while(!![]){try{const _0x57da8c=-parseInt(_0x1bc98d(0x11c))*-parseInt(_0x1bc98d(0x12d))+-parseInt(_0x1bc98d(0x117))+-parseInt(_0x1bc98d(0x13a))*parseInt(_0x1bc98d(0x136))+parseInt(_0x1bc98d(0x13b))*-parseInt(_0x1bc98d(0x142))+-parseInt(_0x1bc98d(0x12f))*-parseInt(_0x1bc98d(0x114))+parseInt(_0x1bc98d(0x143))*parseInt(_0x1bc98d(0x14a))+parseInt(_0x1bc98d(0x127));if(_0x57da8c===_0x545964)break;else _0x47525b['push'](_0x47525b['shift']());}catch(_0xcdc291){_0x47525b['push'](_0x47525b['shift']());}}}(a563_0x1007,0x400f2));var __decorate=this&&this[a563_0x1c5e3f(0x147)]||function(_0x3d91a2,_0x45ce17,_0x59492d,_0x1f0005){const _0x103b18=a563_0x1c5e3f;var _0x569f78=arguments[_0x103b18(0x138)],_0x1c5bf4=_0x569f78<0x3?_0x45ce17:_0x1f0005===null?_0x1f0005=Object['getOwnPropertyDescriptor'](_0x45ce17,_0x59492d):_0x1f0005,_0x39196f;if(typeof Reflect==='object'&&typeof Reflect[_0x103b18(0x121)]===_0x103b18(0x146))_0x1c5bf4=Reflect[_0x103b18(0x121)](_0x3d91a2,_0x45ce17,_0x59492d,_0x1f0005);else{for(var _0x4be217=_0x3d91a2[_0x103b18(0x138)]-0x1;_0x4be217>=0x0;_0x4be217--)if(_0x39196f=_0x3d91a2[_0x4be217])_0x1c5bf4=(_0x569f78<0x3?_0x39196f(_0x1c5bf4):_0x569f78>0x3?_0x39196f(_0x45ce17,_0x59492d,_0x1c5bf4):_0x39196f(_0x45ce17,_0x59492d))||_0x1c5bf4;}return _0x569f78>0x3&&_0x1c5bf4&&Object[_0x103b18(0x12a)](_0x45ce17,_0x59492d,_0x1c5bf4),_0x1c5bf4;},__metadata=this&&this[a563_0x1c5e3f(0x128)]||function(_0x19d6ea,_0x19d76f){const _0x983fe3=a563_0x1c5e3f;if(typeof Reflect==='object'&&typeof Reflect[_0x983fe3(0x11e)]===_0x983fe3(0x146))return Reflect[_0x983fe3(0x11e)](_0x19d6ea,_0x19d76f);},__param=this&&this[a563_0x1c5e3f(0x11b)]||function(_0x24e082,_0x5d5f35){return function(_0x3ad997,_0x391963){_0x5d5f35(_0x3ad997,_0x391963,_0x24e082);};};function a563_0x3383(_0x12989a,_0x5238ed){return a563_0x3383=function(_0x100791,_0x338364){_0x100791=_0x100791-0x112;let _0x1f2545=a563_0x1007[_0x100791];return _0x1f2545;},a563_0x3383(_0x12989a,_0x5238ed);}Object[a563_0x1c5e3f(0x12a)](exports,'__esModule',{'value':!![]}),exports[a563_0x1c5e3f(0x132)]=void 0x0;const common_1=require(a563_0x1c5e3f(0x145)),mongoose_1=require(a563_0x1c5e3f(0x135)),kernel_1=require('../../../kernel'),services_1=require('../../file/services'),settings_1=require('../../settings'),constants_1=require('../../settings/constants'),constants_2=require(a563_0x1c5e3f(0x140)),providers_1=require(a563_0x1c5e3f(0x125)),services_2=require('../services');let ModelListener=class ModelListener{constructor(_0x2da0a7,_0x1dfac2,_0x184fa2,_0xe8716b,_0x481bf0){const _0x5b38f3=a563_0x1c5e3f;this[_0x5b38f3(0x134)]=_0x2da0a7,this['studioService']=_0x1dfac2,this[_0x5b38f3(0x12b)]=_0x184fa2,this[_0x5b38f3(0x12c)]=_0xe8716b,this['fileService']=_0x481bf0,this[_0x5b38f3(0x12b)][_0x5b38f3(0x137)](constants_2[_0x5b38f3(0x141)],_0x5b38f3(0x123),this[_0x5b38f3(0x139)][_0x5b38f3(0x148)](this));}async['createStudioHandler'](_0x5a2c57){const _0x12cac3=a563_0x1c5e3f;try{if(_0x5a2c57[_0x12cac3(0x13f)]!==constants_2[_0x12cac3(0x11d)][_0x12cac3(0x120)])return;const {data:_0x1d6e06}=_0x5a2c57,_0xe6a12e=await this[_0x12cac3(0x149)][_0x12cac3(0x119)](_0x1d6e06[_0x12cac3(0x133)]);if(!_0xe6a12e)return;const [_0x515456]=await Promise[_0x12cac3(0x12e)]([this[_0x12cac3(0x12c)][_0x12cac3(0x122)](constants_1[_0x12cac3(0x13d)][_0x12cac3(0x113)]),_0xe6a12e['documentVerificationId']?this['fileService'][_0x12cac3(0x116)](_0xe6a12e['documentVerificationId'],{'itemId':_0xe6a12e[_0x12cac3(0x133)],'itemType':_0x12cac3(0x129)}):null]);_0xe6a12e[_0x12cac3(0x13c)]=_0x515456||parseInt(process[_0x12cac3(0x126)][_0x12cac3(0x130)],0xa),await this['studioModel'][_0x12cac3(0x131)]({'_id':_0x1d6e06['_id']},{'$set':{'defaultStudioCommission':_0x515456}});}catch(_0x2ab73f){console[_0x12cac3(0x11a)](_0x2ab73f);}}};ModelListener=__decorate([common_1[a563_0x1c5e3f(0x144)](),__param(0x0,common_1[a563_0x1c5e3f(0x115)](providers_1[a563_0x1c5e3f(0x124)])),__metadata(a563_0x1c5e3f(0x112),[mongoose_1['Model'],services_2[a563_0x1c5e3f(0x13e)],kernel_1['QueueEventService'],settings_1[a563_0x1c5e3f(0x11f)],services_1[a563_0x1c5e3f(0x118)]])],ModelListener),exports[a563_0x1c5e3f(0x132)]=ModelListener;