'use strict';const a161_0x6947=['createFromMulter','2835CUUzdZ','switchToHttp','28180JCJLCk','multer','defineProperty','createFolderIfNotExists','sync','destination','nestjs-config','length','fieldname','mixin','getRequest','@nestjs/common','16516HcRkYr','decorate','351682OsbBgq','map','publicDir','2JpiVgx','../services','__metadata','handle','createAlias','object','design:paramtypes','521636HOoBBr','originalname','forEach','metadata','StringHelper','randomString','intercept','1hxWAWp','Injectable','fileName','__decorate','../../../kernel','toLocaleLowerCase','file','53lQQGUK','get','user','options','147372qPlPEd','136QBlLaV','875539LcdAqu','uploader','fieldName','fileService','fields','mkdirp','ConfigService','getResponse','existsSync','33YeJNsh','config','getExt','FileService','getFileName','files'];const a161_0x394226=a161_0x2ae6;function a161_0x2ae6(_0x2991d2,_0x18a6d9){return a161_0x2ae6=function(_0x69471a,_0x2ae623){_0x69471a=_0x69471a-0xe1;let _0x2b9970=a161_0x6947[_0x69471a];return _0x2b9970;},a161_0x2ae6(_0x2991d2,_0x18a6d9);}(function(_0x13f18d,_0x4bae28){const _0x24e8c2=a161_0x2ae6;while(!![]){try{const _0x360cdc=parseInt(_0x24e8c2(0x114))*parseInt(_0x24e8c2(0xfa))+-parseInt(_0x24e8c2(0x118))+parseInt(_0x24e8c2(0xff))*parseInt(_0x24e8c2(0x106))+parseInt(_0x24e8c2(0xee))*-parseInt(_0x24e8c2(0xe5))+parseInt(_0x24e8c2(0x10d))*-parseInt(_0x24e8c2(0x11a))+parseInt(_0x24e8c2(0xfc))+parseInt(_0x24e8c2(0xec))*parseInt(_0x24e8c2(0x119));if(_0x360cdc===_0x4bae28)break;else _0x13f18d['push'](_0x13f18d['shift']());}catch(_0x33a697){_0x13f18d['push'](_0x13f18d['shift']());}}}(a161_0x6947,0xaba23));var __decorate=this&&this[a161_0x394226(0x110)]||function(_0x224143,_0xc75e7e,_0x5ad62e,_0x4c9f62){const _0x4eb4db=a161_0x394226;var _0x2216c1=arguments['length'],_0x3dc908=_0x2216c1<0x3?_0xc75e7e:_0x4c9f62===null?_0x4c9f62=Object['getOwnPropertyDescriptor'](_0xc75e7e,_0x5ad62e):_0x4c9f62,_0x399732;if(typeof Reflect==='object'&&typeof Reflect[_0x4eb4db(0xfb)]==='function')_0x3dc908=Reflect[_0x4eb4db(0xfb)](_0x224143,_0xc75e7e,_0x5ad62e,_0x4c9f62);else{for(var _0x419a6f=_0x224143[_0x4eb4db(0xf5)]-0x1;_0x419a6f>=0x0;_0x419a6f--)if(_0x399732=_0x224143[_0x419a6f])_0x3dc908=(_0x2216c1<0x3?_0x399732(_0x3dc908):_0x2216c1>0x3?_0x399732(_0xc75e7e,_0x5ad62e,_0x3dc908):_0x399732(_0xc75e7e,_0x5ad62e))||_0x3dc908;}return _0x2216c1>0x3&&_0x3dc908&&Object[_0x4eb4db(0xf0)](_0xc75e7e,_0x5ad62e,_0x3dc908),_0x3dc908;},__metadata=this&&this[a161_0x394226(0x101)]||function(_0x10476b,_0x355e58){const _0x36aae1=a161_0x394226;if(typeof Reflect===_0x36aae1(0x104)&&typeof Reflect['metadata']==='function')return Reflect[_0x36aae1(0x109)](_0x10476b,_0x355e58);};Object[a161_0x394226(0xf0)](exports,'__esModule',{'value':!![]}),exports['MultiFileUploadInterceptor']=void 0x0;const common_1=require(a161_0x394226(0xf9)),multer=require(a161_0x394226(0xef)),nestjs_config_1=require(a161_0x394226(0xf4)),fs_1=require('fs'),mkdirp=require(a161_0x394226(0xe1)),kernel_1=require(a161_0x394226(0x111)),services_1=require(a161_0x394226(0x100)),multer_utils_1=require('../lib/multer/multer.utils');function MultiFileUploadInterceptor(_0x3c4ad6,_0x55ed8d={}){const _0x5e027b=a161_0x394226;let _0x6c7203=class _0x39a8d9{constructor(_0x1e6050,_0x3377ad){const _0x2ecb50=a161_0x2ae6;this[_0x2ecb50(0xe6)]=_0x1e6050,this['fileService']=_0x3377ad,_0x3c4ad6[_0x2ecb50(0xfd)](async _0x3eb3d2=>{const _0x4613c6=_0x2ecb50,{options:options={}}=_0x3eb3d2,_0x269a55=options[_0x4613c6(0xf3)]||this[_0x4613c6(0xe6)]['get'](_0x4613c6(0x113))[_0x4613c6(0xfe)];this[_0x4613c6(0xf1)](_0x269a55);});}async[_0x5e027b(0xf1)](_0x511aa7){const _0x2138d5=_0x5e027b;!fs_1[_0x2138d5(0xe4)](_0x511aa7)&&mkdirp[_0x2138d5(0xf2)](_0x511aa7);}async[_0x5e027b(0x10c)](_0x3bb193,_0x229398){const _0x35ee2b=_0x5e027b,_0x5839c1=_0x3bb193[_0x35ee2b(0xed)](),_0x264dc5={},_0x23a1a5={};_0x3c4ad6[_0x35ee2b(0x108)](_0x5f1bb0=>{const _0x21b85b=_0x35ee2b,{fieldName:_0x21ce73,options:options={}}=_0x5f1bb0;_0x264dc5[_0x21ce73]=options[_0x21b85b(0xf3)]||this[_0x21b85b(0xe6)][_0x21b85b(0x115)](_0x21b85b(0x113))[_0x21b85b(0xfe)],options[_0x21b85b(0x10f)]&&(_0x23a1a5[_0x21ce73]=options['fileName']);});const _0xce0e7=multer['diskStorage']({'destination'(_0x19b2f7,_0x146e55,_0x518b5f){const _0x556499=_0x35ee2b;_0x518b5f(null,_0x264dc5[_0x146e55[_0x556499(0xf6)]]);},'filename'(_0x36bed3,_0x205639,_0x559f82){const _0x20c5f5=_0x35ee2b;if(_0x23a1a5[_0x205639[_0x20c5f5(0xf6)]])return _0x559f82(null,_0x23a1a5[_0x205639[_0x20c5f5(0xf6)]]);const _0x202340=(kernel_1[_0x20c5f5(0x10a)][_0x20c5f5(0xe7)](_0x205639[_0x20c5f5(0x107)])||'')[_0x20c5f5(0x112)](),_0x23bec9=kernel_1['StringHelper'][_0x20c5f5(0xe9)](_0x205639[_0x20c5f5(0x107)],!![]),_0x34373f=kernel_1[_0x20c5f5(0x10a)][_0x20c5f5(0x10b)](0x5),_0x36c742=kernel_1[_0x20c5f5(0x10a)][_0x20c5f5(0x103)](_0x34373f+'-'+_0x23bec9)['toLocaleLowerCase']()+_0x202340;return _0x559f82(null,_0x36c742);}}),_0x542d1d=multer({'storage':_0xce0e7})[_0x35ee2b(0x11e)](_0x3c4ad6['map'](_0x57ae46=>({'name':_0x57ae46[_0x35ee2b(0x11c)]})));await new Promise((_0x3b9ec3,_0x25236e)=>_0x542d1d(_0x5839c1['getRequest'](),_0x5839c1[_0x35ee2b(0xe3)](),_0x1a8087=>{if(_0x1a8087){const _0x25f1f0=multer_utils_1['transformException'](_0x1a8087);return _0x25236e(_0x25f1f0);}return _0x3b9ec3(null);}));const _0x3d9162=_0x5839c1[_0x35ee2b(0xf8)]();if(!_0x3d9162['files'])_0x3d9162[_0x35ee2b(0xea)]={};const _0x42da7d=_0x3d9162['files']||{};!_0x55ed8d[_0x35ee2b(0x11b)]&&_0x3d9162[_0x35ee2b(0x116)]&&(_0x55ed8d[_0x35ee2b(0x11b)]=_0x3d9162[_0x35ee2b(0x116)]);for(const _0x3a40fb of _0x3c4ad6){const _0x192452=_0x42da7d[_0x3a40fb[_0x35ee2b(0x11c)]];if(_0x192452&&_0x192452[_0x35ee2b(0xf5)]){const _0x2eed9a=await this[_0x35ee2b(0x11d)][_0x35ee2b(0xeb)](_0x3a40fb['type'],_0x192452[0x0],_0x3a40fb[_0x35ee2b(0x117)]);_0x3d9162[_0x35ee2b(0xea)][_0x3a40fb[_0x35ee2b(0x11c)]]=_0x2eed9a;}}return _0x229398[_0x35ee2b(0x102)]();}};_0x6c7203=__decorate([common_1[_0x5e027b(0x10e)](),__metadata(_0x5e027b(0x105),[nestjs_config_1[_0x5e027b(0xe2)],services_1[_0x5e027b(0xe8)]])],_0x6c7203);const _0x1a348b=common_1[_0x5e027b(0xf7)](_0x6c7203);return _0x1a348b;}exports['MultiFileUploadInterceptor']=MultiFileUploadInterceptor;