'use strict';const a159_0x4c97=['nestjs-config','metadata','uploader','createFolderIfNotExists','user','getResponse','@nestjs/common','327017HpOxPg','intercept','handle','file','destination','FileService','__esModule','multer','331358yloPZx','../lib/multer/multer.utils','__metadata','originalname','design:paramtypes','publicDir','defineProperty','FileUploadInterceptor','function','config','sync','getFileName','fileService','StringHelper','diskStorage','2KelQDp','existsSync','switchToHttp','ConfigService','getExt','mixin','920769BZsUFu','getOwnPropertyDescriptor','single','toLocaleLowerCase','Injectable','224911iypvqR','../../../kernel','getRequest','1007943qbgnoA','1171338qxCVKq','uploadDir','length','object','createFromMulter','1371341ZLcTpJ','decorate'];const a159_0x56726d=a159_0x1e6c;function a159_0x1e6c(_0xb78e46,_0x496585){return a159_0x1e6c=function(_0x4c97ec,_0x1e6c3c){_0x4c97ec=_0x4c97ec-0x1e9;let _0x5e3608=a159_0x4c97[_0x4c97ec];return _0x5e3608;},a159_0x1e6c(_0xb78e46,_0x496585);}(function(_0x180239,_0x59923e){const _0x3cbbf6=a159_0x1e6c;while(!![]){try{const _0x5735e4=parseInt(_0x3cbbf6(0x216))+parseInt(_0x3cbbf6(0x20e))+-parseInt(_0x3cbbf6(0x205))+-parseInt(_0x3cbbf6(0x1fc))*-parseInt(_0x3cbbf6(0x1f1))+parseInt(_0x3cbbf6(0x1f7))+-parseInt(_0x3cbbf6(0x1ff))+parseInt(_0x3cbbf6(0x200));if(_0x5735e4===_0x59923e)break;else _0x180239['push'](_0x180239['shift']());}catch(_0xdcbdbb){_0x180239['push'](_0x180239['shift']());}}}(a159_0x4c97,0xc871c));var __decorate=this&&this['__decorate']||function(_0x262aa2,_0x22cc5b,_0x458f39,_0xb0c87b){const _0x1a395f=a159_0x1e6c;var _0x2e8190=arguments[_0x1a395f(0x202)],_0x1a830d=_0x2e8190<0x3?_0x22cc5b:_0xb0c87b===null?_0xb0c87b=Object[_0x1a395f(0x1f8)](_0x22cc5b,_0x458f39):_0xb0c87b,_0x1211b4;if(typeof Reflect===_0x1a395f(0x203)&&typeof Reflect['decorate']==='function')_0x1a830d=Reflect[_0x1a395f(0x206)](_0x262aa2,_0x22cc5b,_0x458f39,_0xb0c87b);else{for(var _0x4379a9=_0x262aa2[_0x1a395f(0x202)]-0x1;_0x4379a9>=0x0;_0x4379a9--)if(_0x1211b4=_0x262aa2[_0x4379a9])_0x1a830d=(_0x2e8190<0x3?_0x1211b4(_0x1a830d):_0x2e8190>0x3?_0x1211b4(_0x22cc5b,_0x458f39,_0x1a830d):_0x1211b4(_0x22cc5b,_0x458f39))||_0x1a830d;}return _0x2e8190>0x3&&_0x1a830d&&Object[_0x1a395f(0x21c)](_0x22cc5b,_0x458f39,_0x1a830d),_0x1a830d;},__metadata=this&&this[a159_0x56726d(0x218)]||function(_0x25e7e4,_0x2d92d2){const _0x51b163=a159_0x56726d;if(typeof Reflect===_0x51b163(0x203)&&typeof Reflect[_0x51b163(0x208)]===_0x51b163(0x1ea))return Reflect['metadata'](_0x25e7e4,_0x2d92d2);};Object[a159_0x56726d(0x21c)](exports,a159_0x56726d(0x214),{'value':!![]}),exports[a159_0x56726d(0x1e9)]=void 0x0;const common_1=require(a159_0x56726d(0x20d)),multer=require(a159_0x56726d(0x215)),nestjs_config_1=require(a159_0x56726d(0x207)),fs_1=require('fs'),mkdirp=require('mkdirp'),kernel_1=require(a159_0x56726d(0x1fd)),services_1=require('../services'),multer_utils_1=require(a159_0x56726d(0x217));function FileUploadInterceptor(_0x18a25e=a159_0x56726d(0x211),_0x351d59='file',_0x1a6261={}){const _0x43d775=a159_0x56726d;let _0xede950=class _0x1cce44{constructor(_0x74bb8c,_0x19cb2c){const _0x2c6a3b=a159_0x1e6c;this[_0x2c6a3b(0x1eb)]=_0x74bb8c,this[_0x2c6a3b(0x1ee)]=_0x19cb2c,this[_0x2c6a3b(0x201)]=_0x1a6261[_0x2c6a3b(0x212)]||this[_0x2c6a3b(0x1eb)]['get'](_0x2c6a3b(0x211))[_0x2c6a3b(0x21b)],this[_0x2c6a3b(0x20a)](this[_0x2c6a3b(0x201)]);}async[_0x43d775(0x20a)](_0x5183d0){const _0x301877=_0x43d775;!fs_1[_0x301877(0x1f2)](_0x5183d0)&&mkdirp[_0x301877(0x1ec)](_0x5183d0);}async[_0x43d775(0x20f)](_0x4762ae,_0x1dd48b){const _0x3e9fd7=_0x43d775,_0x3a8c94=_0x4762ae[_0x3e9fd7(0x1f3)](),{uploadDir:_0x4910c3}=this,_0x1417b1=multer[_0x3e9fd7(0x1f0)]({'destination':(_0xe93c07,_0x3903a0,_0x295ebc)=>{_0x295ebc(null,_0x4910c3);},'filename':(_0x332068,_0x38f5fb,_0x29a0d1)=>{const _0xb45d5d=_0x3e9fd7;if(_0x1a6261['fileName'])return _0x29a0d1(null,_0x1a6261['fileName']);const _0x2f20df=(kernel_1['StringHelper'][_0xb45d5d(0x1f5)](_0x38f5fb[_0xb45d5d(0x219)])||'')['toLocaleLowerCase'](),_0x5c4c46=kernel_1[_0xb45d5d(0x1ef)][_0xb45d5d(0x1ed)](_0x38f5fb[_0xb45d5d(0x219)],!![]),_0xfa41aa=kernel_1[_0xb45d5d(0x1ef)]['randomString'](0x5),_0x1bce09=kernel_1[_0xb45d5d(0x1ef)]['createAlias'](_0xfa41aa+'-'+_0x5c4c46)[_0xb45d5d(0x1fa)]()+_0x2f20df;return _0x29a0d1(null,_0x1bce09);}}),_0x3c724f=multer({'storage':_0x1417b1})[_0x3e9fd7(0x1f9)](_0x351d59);await new Promise((_0xeed105,_0x1abcfe)=>_0x3c724f(_0x3a8c94[_0x3e9fd7(0x1fe)](),_0x3a8c94[_0x3e9fd7(0x20c)](),_0x2f642c=>{if(_0x2f642c){const _0x65b1e1=multer_utils_1['transformException'](_0x2f642c);return _0x1abcfe(_0x65b1e1);}return _0xeed105(null);}));const _0xe7caba=_0x3a8c94[_0x3e9fd7(0x1fe)](),_0x4e0b8d=_0xe7caba[_0x3e9fd7(0x211)];!_0x1a6261[_0x3e9fd7(0x209)]&&_0xe7caba[_0x3e9fd7(0x20b)]&&(_0x1a6261[_0x3e9fd7(0x209)]=_0xe7caba[_0x3e9fd7(0x20b)]);const _0x1ccdef=await this[_0x3e9fd7(0x1ee)][_0x3e9fd7(0x204)](_0x18a25e,_0x4e0b8d,_0x1a6261);return _0xe7caba[_0x3e9fd7(0x211)]=_0x1ccdef,_0x1dd48b[_0x3e9fd7(0x210)]();}};_0xede950=__decorate([common_1[_0x43d775(0x1fb)](),__metadata(_0x43d775(0x21a),[nestjs_config_1[_0x43d775(0x1f4)],services_1[_0x43d775(0x213)]])],_0xede950);const _0x47460a=common_1[_0x43d775(0x1f6)](_0xede950);return _0x47460a;}exports['FileUploadInterceptor']=FileUploadInterceptor;