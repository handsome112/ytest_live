'use strict';const a145_0x219d=['313265orlpIQ','performerService','find','doUnlike','findById','Model','userSearch','sort','ownerId','560847trumIF','1jzSgmy','design:paramtypes','PerformerService','length','1207553upJZtX','doLike','316kOXkTv','toString','../dtos','14489blLwhY','assign','findByIds','FAVOURITE_MODEL_PROVIDER','sortBy','1171126VQqayk','count','__decorate','33585OxfVWk','EVENT','../../../kernel','findOne','_id','skip','queueEventService','performerSearch','FavouriteDto','../../performer/dtos','4027jZWtWH','metadata','50uwKHBq','decorate','map','../providers','object','@nestjs/common','../../performer/services','getAllFollowerIdsByPerformerId','5igdMFo','__param','function','31QhjcNE','FavouriteModel','EntityNotFoundException','QueueEvent','save','../../../kernel/constants','../constants','favoriteId','remove','Inject','__esModule','limit','QueueEventService','publish','all','CREATED','lean','../../user/dtos','defineProperty','PERFORMER_FAVORITE_CHANNEL','toResponse'];const a145_0x2206a7=a145_0xb9d4;function a145_0xb9d4(_0x4c2a03,_0x475bd3){return a145_0xb9d4=function(_0x219d91,_0xb9d4a8){_0x219d91=_0x219d91-0xc7;let _0x415213=a145_0x219d[_0x219d91];return _0x415213;},a145_0xb9d4(_0x4c2a03,_0x475bd3);}(function(_0x3bd82c,_0x5ec8d3){const _0x2036a4=a145_0xb9d4;while(!![]){try{const _0x9937a1=parseInt(_0x2036a4(0xda))*parseInt(_0x2036a4(0xe8))+-parseInt(_0x2036a4(0xde))+-parseInt(_0x2036a4(0xf5))*-parseInt(_0x2036a4(0x102))+-parseInt(_0x2036a4(0xd9))+-parseInt(_0x2036a4(0xeb))*parseInt(_0x2036a4(0xf7))+-parseInt(_0x2036a4(0xff))*parseInt(_0x2036a4(0xd0))+parseInt(_0x2036a4(0xe3))*parseInt(_0x2036a4(0xe0));if(_0x9937a1===_0x5ec8d3)break;else _0x3bd82c['push'](_0x3bd82c['shift']());}catch(_0x51c109){_0x3bd82c['push'](_0x3bd82c['shift']());}}}(a145_0x219d,0xd2160));var __decorate=this&&this[a145_0x2206a7(0xea)]||function(_0x3f6956,_0x2676b1,_0x42a8d5,_0x183723){const _0x567d6c=a145_0x2206a7;var _0x2a4714=arguments[_0x567d6c(0xdd)],_0x3e2fcc=_0x2a4714<0x3?_0x2676b1:_0x183723===null?_0x183723=Object['getOwnPropertyDescriptor'](_0x2676b1,_0x42a8d5):_0x183723,_0x5c2aa7;if(typeof Reflect===_0x567d6c(0xfb)&&typeof Reflect[_0x567d6c(0xf8)]===_0x567d6c(0x101))_0x3e2fcc=Reflect['decorate'](_0x3f6956,_0x2676b1,_0x42a8d5,_0x183723);else{for(var _0x14f60f=_0x3f6956[_0x567d6c(0xdd)]-0x1;_0x14f60f>=0x0;_0x14f60f--)if(_0x5c2aa7=_0x3f6956[_0x14f60f])_0x3e2fcc=(_0x2a4714<0x3?_0x5c2aa7(_0x3e2fcc):_0x2a4714>0x3?_0x5c2aa7(_0x2676b1,_0x42a8d5,_0x3e2fcc):_0x5c2aa7(_0x2676b1,_0x42a8d5))||_0x3e2fcc;}return _0x2a4714>0x3&&_0x3e2fcc&&Object[_0x567d6c(0xcd)](_0x2676b1,_0x42a8d5,_0x3e2fcc),_0x3e2fcc;},__metadata=this&&this['__metadata']||function(_0x38e5f9,_0x459b91){const _0x2a4b76=a145_0x2206a7;if(typeof Reflect===_0x2a4b76(0xfb)&&typeof Reflect[_0x2a4b76(0xf6)]===_0x2a4b76(0x101))return Reflect[_0x2a4b76(0xf6)](_0x38e5f9,_0x459b91);},__param=this&&this[a145_0x2206a7(0x100)]||function(_0x2060dc,_0x5dd5c4){return function(_0x29f7b6,_0x43fadc){_0x5dd5c4(_0x29f7b6,_0x43fadc,_0x2060dc);};};Object[a145_0x2206a7(0xcd)](exports,a145_0x2206a7(0x10c),{'value':!![]}),exports['FavouriteService']=void 0x0;const common_1=require(a145_0x2206a7(0xfc)),kernel_1=require(a145_0x2206a7(0xed)),mongoose_1=require('mongoose'),dtos_1=require(a145_0x2206a7(0xcc)),dtos_2=require(a145_0x2206a7(0xf4)),constants_1=require(a145_0x2206a7(0x107)),providers_1=require(a145_0x2206a7(0xfa)),services_1=require(a145_0x2206a7(0xfd)),dtos_3=require(a145_0x2206a7(0xe2)),constants_2=require(a145_0x2206a7(0x108));let FavouriteService=class FavouriteService{constructor(_0x442ed6,_0x1d25de,_0x5df168){const _0x18af06=a145_0x2206a7;this['FavouriteModel']=_0x442ed6,this[_0x18af06(0xd1)]=_0x1d25de,this[_0x18af06(0xf1)]=_0x5df168;}async[a145_0x2206a7(0xd2)](_0x36cbe6){const _0x177496=a145_0x2206a7,_0x488d39=await this[_0x177496(0x103)]['find'](_0x36cbe6);return _0x488d39;}async[a145_0x2206a7(0xee)](_0x1821d8){const _0x107a80=a145_0x2206a7,_0x3d6909=await this[_0x107a80(0x103)][_0x107a80(0xee)](_0x1821d8);return _0x3d6909;}async['findById'](_0x32e47f){const _0x187c0e=a145_0x2206a7,_0x34b4a8=await this[_0x187c0e(0x103)]['findOne']({'_id':_0x32e47f});return _0x34b4a8;}async[a145_0x2206a7(0xdf)](_0x2bdcd1,_0x3cbb48){const _0x245e88=a145_0x2206a7,_0x29662f=await this[_0x245e88(0xd1)]['findById'](_0x2bdcd1);if(!_0x29662f)throw new kernel_1[(_0x245e88(0x104))]();let _0x54fd7a=await this[_0x245e88(0x103)][_0x245e88(0xee)]({'favoriteId':_0x2bdcd1,'ownerId':_0x3cbb48});return!_0x54fd7a&&(_0x54fd7a=new this['FavouriteModel'](),_0x54fd7a[_0x245e88(0xd8)]=_0x3cbb48,_0x54fd7a[_0x245e88(0x109)]=_0x29662f[_0x245e88(0xef)],await _0x54fd7a[_0x245e88(0x106)]()),this[_0x245e88(0xf1)][_0x245e88(0xc8)](new kernel_1[(_0x245e88(0x105))]({'channel':constants_2[_0x245e88(0xce)],'eventName':constants_1[_0x245e88(0xec)][_0x245e88(0xca)],'data':{'performerId':_0x2bdcd1}})),{'success':!![]};}async[a145_0x2206a7(0xd3)](_0x1208c8,_0x15f1f7){const _0x118ca7=a145_0x2206a7,_0x1ec51b=await this[_0x118ca7(0xd1)][_0x118ca7(0xd4)](_0x1208c8);if(!_0x1ec51b)throw new kernel_1[(_0x118ca7(0x104))]();const _0x1ea88d=await this[_0x118ca7(0x103)]['findOne']({'favoriteId':_0x1208c8,'ownerId':_0x15f1f7});if(!_0x1ea88d)throw new kernel_1[(_0x118ca7(0x104))]();return await _0x1ea88d[_0x118ca7(0x10a)](),this[_0x118ca7(0xf1)][_0x118ca7(0xc8)](new kernel_1[(_0x118ca7(0x105))]({'channel':constants_2[_0x118ca7(0xce)],'eventName':constants_1['EVENT']['DELETED'],'data':{'performerId':_0x1208c8}})),{'success':!![]};}async[a145_0x2206a7(0xd6)](_0x4e32f5,_0x2b2693){const _0x3782af=a145_0x2206a7,_0x2bb974={};_0x2bb974[_0x3782af(0xd8)]=_0x2b2693['_id'];let _0x322c61={};_0x4e32f5[_0x3782af(0xd7)]&&_0x4e32f5[_0x3782af(0xe7)]&&(_0x322c61={[_0x4e32f5[_0x3782af(0xe7)]]:_0x4e32f5[_0x3782af(0xd7)]});const [_0x86952e,_0x408461]=await Promise['all']([this[_0x3782af(0x103)][_0x3782af(0xd2)](_0x2bb974)[_0x3782af(0xcb)]()[_0x3782af(0xd7)](_0x322c61)[_0x3782af(0x10d)](parseInt(_0x4e32f5[_0x3782af(0x10d)],0xa))[_0x3782af(0xf0)](parseInt(_0x4e32f5['offset'],0xa)),this[_0x3782af(0x103)][_0x3782af(0xe9)](_0x2bb974)]),_0x59d9e1=_0x86952e[_0x3782af(0xf9)](_0x52ff7a=>_0x52ff7a[_0x3782af(0x109)]),_0x29f3b8=_0x59d9e1[_0x3782af(0xdd)]?await this['performerService'][_0x3782af(0xe5)](_0x59d9e1):[],_0xccc17f=_0x86952e[_0x3782af(0xf9)](_0x146731=>{const _0x284018=_0x3782af,_0x7fb13e=_0x146731['favoriteId']&&_0x29f3b8[_0x284018(0xd2)](_0x3a2cbe=>_0x3a2cbe[_0x284018(0xef)][_0x284018(0xe1)]()===_0x146731['favoriteId'][_0x284018(0xe1)]());return Object['assign'](Object[_0x284018(0xe4)]({},_0x146731),{'performer':_0x7fb13e&&_0x7fb13e[_0x284018(0xcf)]()});});return{'total':_0x408461,'data':_0xccc17f[_0x3782af(0xf9)](_0x57fb55=>new dtos_3[(_0x3782af(0xf3))](_0x57fb55))};}async[a145_0x2206a7(0xf2)](_0xfdf8c9,_0x397bf9){const _0x1a6bbe=a145_0x2206a7,_0x279bf6={};_0x279bf6[_0x1a6bbe(0x109)]=_0x397bf9[_0x1a6bbe(0xef)];let _0x1023bd={};_0xfdf8c9[_0x1a6bbe(0xd7)]&&_0xfdf8c9[_0x1a6bbe(0xe7)]&&(_0x1023bd={[_0xfdf8c9[_0x1a6bbe(0xe7)]]:_0xfdf8c9[_0x1a6bbe(0xd7)]});const [_0x37668f,_0x15712e]=await Promise[_0x1a6bbe(0xc9)]([this[_0x1a6bbe(0x103)][_0x1a6bbe(0xd2)](_0x279bf6)[_0x1a6bbe(0xcb)]()[_0x1a6bbe(0xd7)](_0x1023bd)[_0x1a6bbe(0x10d)](parseInt(_0xfdf8c9[_0x1a6bbe(0x10d)],0xa))[_0x1a6bbe(0xf0)](parseInt(_0xfdf8c9['offset'],0xa)),this['FavouriteModel']['count'](_0x279bf6)]),_0x2201f1=_0x37668f[_0x1a6bbe(0xf9)](_0x470751=>_0x470751['ownerId']),_0x23896c=_0x2201f1['length']?await this['performerService'][_0x1a6bbe(0xe5)](_0x2201f1):[],_0x5f3ddd=_0x37668f[_0x1a6bbe(0xf9)](_0x581026=>{const _0x23f542=_0x1a6bbe,_0x19b565=_0x581026['ownerId']&&_0x23896c[_0x23f542(0xd2)](_0x2eda8a=>_0x2eda8a[_0x23f542(0xef)][_0x23f542(0xe1)]()===_0x581026[_0x23f542(0xd8)][_0x23f542(0xe1)]());if(_0x19b565)return Object['assign'](Object[_0x23f542(0xe4)]({},_0x581026),{'user':_0x19b565[_0x23f542(0xcf)]()});return _0x581026;});return{'total':_0x15712e,'data':_0x5f3ddd[_0x1a6bbe(0xf9)](_0x37b309=>new dtos_3[(_0x1a6bbe(0xf3))](_0x37b309))};}async[a145_0x2206a7(0xfe)](_0xaca4f0){const _0x1781aa=a145_0x2206a7,_0x4bd362=await this['FavouriteModel'][_0x1781aa(0xd2)]({'favoriteId':_0xaca4f0});return _0x4bd362['map'](_0x1aac61=>_0x1aac61[_0x1781aa(0xd8)]);}};FavouriteService=__decorate([common_1['Injectable'](),__param(0x0,common_1[a145_0x2206a7(0x10b)](providers_1[a145_0x2206a7(0xe6)])),__metadata(a145_0x2206a7(0xdb),[mongoose_1[a145_0x2206a7(0xd5)],services_1[a145_0x2206a7(0xdc)],kernel_1[a145_0x2206a7(0xc7)]])],FavouriteService),exports['FavouriteService']=FavouriteService;