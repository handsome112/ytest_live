'use strict';const a375_0x710a=['generateDownloadLink','263611yPjvzk','fileService','ValidationPipe','3931HjUFGK','@nestjs/common','../services/product-search.service','Res','__esModule','details','../../../kernel','../../auth/guards','design:returntype','ProductSearchService','DataResponse','paymentTokenService','digitalFileId','Query','length','ProductSearchRequest','UseGuards','1426BBLUJt','Get','../services/product.service','../../auth/decorators','AuthGuard','type','DIGITAL','user/performer-assets/products','../constants','token','__metadata','metadata','query','function','prototype','46ZyMgjV','PRODUCT_TYPE','UserInterceptor','HttpStatus','Injectable','design:type','map','checkAuth','UserProductsController','object','PaymentTokenService','UNAUTHORIZED','productService','CurrentUser','/search','authService','/:id/download-link','userSearch','UserDto','design:paramtypes','/auth/check','status','FileService','BadRequestException','toPublic','UseInterceptors','2yAFaEN','209171sVlDeR','getDownloadLink','11119qnMKMZ','send','__decorate','search','4dtonlU','getDetails','HttpCode','Request','productSearchService','/:id','195QRRVhm','data','40484FjWDEG','_id','1WLGovs','Param','PURCHASE_ITEM_TYPE','1VjAlUN','Controller','checkBought','283298fgYpsL','../../purchased-item/services'];function a375_0x5180(_0x2eac92,_0x201e7b){return a375_0x5180=function(_0x710a90,_0x518079){_0x710a90=_0x710a90-0x1e3;let _0x56c1f4=a375_0x710a[_0x710a90];return _0x56c1f4;},a375_0x5180(_0x2eac92,_0x201e7b);}const a375_0x240b0d=a375_0x5180;(function(_0xffb862,_0x29899a){const _0x13315b=a375_0x5180;while(!![]){try{const _0x3f3a37=-parseInt(_0x13315b(0x1e4))*parseInt(_0x13315b(0x1ed))+-parseInt(_0x13315b(0x22d))*parseInt(_0x13315b(0x231))+parseInt(_0x13315b(0x1ea))+-parseInt(_0x13315b(0x237))*parseInt(_0x13315b(0x201))+parseInt(_0x13315b(0x22b))*parseInt(_0x13315b(0x1e7))+parseInt(_0x13315b(0x239))*parseInt(_0x13315b(0x22a))+parseInt(_0x13315b(0x1f0))*parseInt(_0x13315b(0x210));if(_0x3f3a37===_0x29899a)break;else _0xffb862['push'](_0xffb862['shift']());}catch(_0x4e597c){_0xffb862['push'](_0xffb862['shift']());}}}(a375_0x710a,0x290aa));var __decorate=this&&this[a375_0x240b0d(0x22f)]||function(_0x950718,_0x11aa18,_0x22ab52,_0x4298de){const _0x359fee=a375_0x240b0d;var _0x591879=arguments[_0x359fee(0x1fe)],_0x245c88=_0x591879<0x3?_0x11aa18:_0x4298de===null?_0x4298de=Object['getOwnPropertyDescriptor'](_0x11aa18,_0x22ab52):_0x4298de,_0x186ce9;if(typeof Reflect===_0x359fee(0x219)&&typeof Reflect['decorate']===_0x359fee(0x20e))_0x245c88=Reflect['decorate'](_0x950718,_0x11aa18,_0x22ab52,_0x4298de);else{for(var _0x1e7ddf=_0x950718[_0x359fee(0x1fe)]-0x1;_0x1e7ddf>=0x0;_0x1e7ddf--)if(_0x186ce9=_0x950718[_0x1e7ddf])_0x245c88=(_0x591879<0x3?_0x186ce9(_0x245c88):_0x591879>0x3?_0x186ce9(_0x11aa18,_0x22ab52,_0x245c88):_0x186ce9(_0x11aa18,_0x22ab52))||_0x245c88;}return _0x591879>0x3&&_0x245c88&&Object['defineProperty'](_0x11aa18,_0x22ab52,_0x245c88),_0x245c88;},__metadata=this&&this[a375_0x240b0d(0x20b)]||function(_0x3c9d90,_0x5e56f8){const _0x313e2c=a375_0x240b0d;if(typeof Reflect==='object'&&typeof Reflect[_0x313e2c(0x20c)]==='function')return Reflect[_0x313e2c(0x20c)](_0x3c9d90,_0x5e56f8);},__param=this&&this['__param']||function(_0x52d7c8,_0x35b744){return function(_0x495356,_0x4a455f){_0x35b744(_0x495356,_0x4a455f,_0x52d7c8);};};Object['defineProperty'](exports,a375_0x240b0d(0x1f4),{'value':!![]}),exports[a375_0x240b0d(0x218)]=void 0x0;const common_1=require(a375_0x240b0d(0x1f1)),kernel_1=require(a375_0x240b0d(0x1f6)),services_1=require('../../auth/services'),decorators_1=require(a375_0x240b0d(0x204)),interceptors_1=require('../../auth/interceptors'),dtos_1=require('../../user/dtos'),guards_1=require(a375_0x240b0d(0x1f7)),services_2=require('../../file/services'),services_3=require(a375_0x240b0d(0x1eb)),constants_1=require('../../purchased-item/constants'),product_service_1=require(a375_0x240b0d(0x203)),product_search_service_1=require(a375_0x240b0d(0x1f2)),payloads_1=require('../payloads'),constants_2=require(a375_0x240b0d(0x209));let UserProductsController=class UserProductsController{constructor(_0x5f13d0,_0x2ec6f5,_0x59f9ab,_0x3c03cc,_0x74e12b){const _0x5e9ba6=a375_0x240b0d;this[_0x5e9ba6(0x21f)]=_0x5f13d0,this[_0x5e9ba6(0x21c)]=_0x2ec6f5,this[_0x5e9ba6(0x235)]=_0x59f9ab,this[_0x5e9ba6(0x1ee)]=_0x3c03cc,this[_0x5e9ba6(0x1fb)]=_0x74e12b;}async[a375_0x240b0d(0x230)](_0x402af1,_0x2a9f3a){const _0x30accd=a375_0x240b0d,_0x46352d=await this[_0x30accd(0x235)][_0x30accd(0x221)](_0x402af1,_0x2a9f3a),_0x38c76c=_0x46352d[_0x30accd(0x238)][_0x30accd(0x216)](_0xd43307=>_0xd43307[_0x30accd(0x228)]());return kernel_1[_0x30accd(0x1fa)]['ok']({'data':_0x38c76c,'total':_0x46352d['total']});}async[a375_0x240b0d(0x1f5)](_0x4e1b60){const _0x2996d2=a375_0x240b0d,_0x55ac17=await this['productService'][_0x2996d2(0x232)](_0x4e1b60);return kernel_1['DataResponse']['ok'](_0x55ac17['toPublic']());}async[a375_0x240b0d(0x22c)](_0x105ff9,_0x139a6a){const _0x4c6ce6=a375_0x240b0d,_0x2c7598=await this[_0x4c6ce6(0x21c)]['findById'](_0x105ff9);if(!_0x2c7598||_0x2c7598[_0x4c6ce6(0x206)]!==constants_2[_0x4c6ce6(0x211)][_0x4c6ce6(0x207)])throw new common_1[(_0x4c6ce6(0x227))]('Invalid\x20product');const _0x6068c4=await this[_0x4c6ce6(0x1fb)][_0x4c6ce6(0x1e9)](_0x2c7598[_0x4c6ce6(0x1e3)],constants_1[_0x4c6ce6(0x1e6)]['PRODUCT'],_0x139a6a);if(!_0x6068c4)throw new common_1['BadRequestException']('Please\x20purchase\x20this\x20product\x20product');const _0x205987=await this[_0x4c6ce6(0x1ee)][_0x4c6ce6(0x1ec)](_0x2c7598[_0x4c6ce6(0x1fc)]);return kernel_1[_0x4c6ce6(0x1fa)]['ok']({'downloadUrl':_0x205987});}async['checkAuth'](_0x16cf45,_0x901dcb){const _0x3d0d86=a375_0x240b0d;if(!_0x16cf45[_0x3d0d86(0x20d)]['token'])return _0x901dcb[_0x3d0d86(0x225)](common_1[_0x3d0d86(0x213)][_0x3d0d86(0x21b)])[_0x3d0d86(0x22e)]();const _0x4d778b=await this['authService']['getSourceFromJWT'](_0x16cf45[_0x3d0d86(0x20d)][_0x3d0d86(0x20a)]);if(!_0x4d778b)return _0x901dcb['status'](common_1[_0x3d0d86(0x213)]['UNAUTHORIZED'])['send']();const _0x28e51c=await this[_0x3d0d86(0x21c)][_0x3d0d86(0x217)](_0x16cf45,_0x4d778b);return _0x901dcb[_0x3d0d86(0x225)](_0x28e51c?common_1[_0x3d0d86(0x213)]['OK']:common_1[_0x3d0d86(0x213)][_0x3d0d86(0x21b)])[_0x3d0d86(0x22e)]();}};__decorate([common_1[a375_0x240b0d(0x202)](a375_0x240b0d(0x21e)),common_1[a375_0x240b0d(0x233)](common_1[a375_0x240b0d(0x213)]['OK']),common_1[a375_0x240b0d(0x229)](interceptors_1[a375_0x240b0d(0x212)]),common_1['UsePipes'](new common_1[(a375_0x240b0d(0x1ef))]({'transform':!![]})),__param(0x0,common_1[a375_0x240b0d(0x1fd)]()),__param(0x1,decorators_1['CurrentUser']()),__metadata('design:type',Function),__metadata('design:paramtypes',[payloads_1[a375_0x240b0d(0x1ff)],dtos_1[a375_0x240b0d(0x222)]]),__metadata('design:returntype',Promise)],UserProductsController['prototype'],a375_0x240b0d(0x230),null),__decorate([common_1['Get'](a375_0x240b0d(0x236)),common_1[a375_0x240b0d(0x200)](guards_1[a375_0x240b0d(0x205)]),common_1[a375_0x240b0d(0x233)](common_1[a375_0x240b0d(0x213)]['OK']),__param(0x0,common_1[a375_0x240b0d(0x1e5)]('id')),__metadata('design:type',Function),__metadata(a375_0x240b0d(0x223),[String]),__metadata(a375_0x240b0d(0x1f8),Promise)],UserProductsController[a375_0x240b0d(0x20f)],a375_0x240b0d(0x1f5),null),__decorate([common_1['Get'](a375_0x240b0d(0x220)),common_1[a375_0x240b0d(0x200)](guards_1[a375_0x240b0d(0x205)]),common_1[a375_0x240b0d(0x233)](common_1[a375_0x240b0d(0x213)]['OK']),__param(0x0,common_1['Param']('id')),__param(0x1,decorators_1[a375_0x240b0d(0x21d)]()),__metadata(a375_0x240b0d(0x215),Function),__metadata(a375_0x240b0d(0x223),[String,dtos_1[a375_0x240b0d(0x222)]]),__metadata('design:returntype',Promise)],UserProductsController[a375_0x240b0d(0x20f)],'getDownloadLink',null),__decorate([common_1[a375_0x240b0d(0x202)](a375_0x240b0d(0x224)),common_1[a375_0x240b0d(0x233)](common_1[a375_0x240b0d(0x213)]['OK']),__param(0x0,common_1[a375_0x240b0d(0x234)]()),__param(0x1,common_1[a375_0x240b0d(0x1f3)]()),__metadata(a375_0x240b0d(0x215),Function),__metadata(a375_0x240b0d(0x223),[Object,Object]),__metadata(a375_0x240b0d(0x1f8),Promise)],UserProductsController[a375_0x240b0d(0x20f)],a375_0x240b0d(0x217),null),UserProductsController=__decorate([common_1[a375_0x240b0d(0x214)](),common_1[a375_0x240b0d(0x1e8)](a375_0x240b0d(0x208)),__metadata(a375_0x240b0d(0x223),[services_1['AuthService'],product_service_1['ProductService'],product_search_service_1[a375_0x240b0d(0x1f9)],services_2[a375_0x240b0d(0x226)],services_3[a375_0x240b0d(0x21a)]])],UserProductsController),exports[a375_0x240b0d(0x218)]=UserProductsController;